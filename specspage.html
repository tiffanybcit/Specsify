<!DOCTYPE html>
<html lang="en">

<head>
    <title>My Result</title>

    <meta charset="UTF-8">
    <!-- Bootstrap for navigation bar -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="script/navbar.js"></script>
    <!-- CSS related to navigation bar -->
    <link rel="stylesheet" href="style/navbar.css">
    <!-- CSS on the fonts-->
    <link href="https://fonts.googleapis.com/css?family=Rubik&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style/specspagecss.css">
    <!-- CSS related to buttons -->
    <link rel="stylesheet" href="style/Button.css">
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-app.js"></script>

    <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-firestore.js"></script>
    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css" />

    <script>
        // Our web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyDWTUQMurE64ovJnLuICKLCgz2zSlsW0eo",
            authDomain: "cybersify-2019.firebaseapp.com",
            databaseURL: "https://cybersify-2019.firebaseio.com",
            projectId: "cybersify-2019",
            storageBucket: "cybersify-2019.appspot.com",
            messagingSenderId: "286797146225",
            appId: "1:286797146225:web:f5c728822bba76ec9053d0"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();
    </script>

</head>

<body>
    <!--Navbar-->
    <nav class="navbar navbar-dark  indigo darken-2" style="background-color: #2f3e9f; margin: 10px;">

        <!-- Navbar brand -->
        <a class="navbar-brand" href="#" style="font-family: 'Rubik', sans-sans-serif;">Specsify</a>

        <!-- Collapse button -->
        <button class="navbar-toggler third-button" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent22" aria-controls="navbarSupportedContent22" aria-expanded="false"
            aria-label="Toggle navigation">
            <div class="animated-icon3"><span></span><span></span><span></span></div>
        </button>

        <!-- Collapsible content -->
        <div class="collapse navbar-collapse" id="navbarSupportedContent22">

            <!-- Links -->
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="Home_page.html">Home<span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="Account_page.html">Account</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="help_us.html">Need help?</a>
                </li>
            </ul>

        </div>

    </nav>

    <div id="homeparagraph" style="text-align: center">
        <h1 id="heading">Your Specifications</h1>
        <!-- Displays the recommendations -->
        <br>
        <br>
        <div id="questionDIV">
            <p class="question">CPU: <span id="stuff"> </span></p>
            <p class="question">Storage: <span id="stuff1"> </span></p>
            <p class="question">RAM: <span id="stuff2"> </span></p>
            <p class="question">Type: <span id="stuff3"> </span></p>
            <p class="question"><span id="stuff4"> </span></p>
        </div>
        <br>
        <br>
        <!-- Go to home page button -->
        <form action="Home_page.html">
            <button class="submitButton" , type="submit">Go to Homepage</button>
        </form>

        <br>
        <!-- Click to get more shops -->
        <button onclick="getShops()" class="submitButton">Click here for some shop recommendations</button>

        <br>
        <br>
        <!-- Recommendations of shops. -->
        <div style="text-align: center">
            <table>
                <tr>
                    <th><a href="https://www.costco.ca/" target="_blank">
                            <p id="store1"></p>
                        </a></th>
                    <th><a href="https://www.bestbuy.ca/en-ca" target="_blank">
                            <p id="store2"></p>
                        </a></th>
                    <th><a href="https://www.amazon.ca/">
                            <p id="store3"></p>
                        </a></th>
                    <th><a href="https://www.staples.ca/">
                            <p id="store4"></p>
                        </a></th>


                </tr>
                <tr>
                    <td>
                        <p id="demo" style="text-align: center"></p>
                    </td>
                    <td>
                        <p id="demo3" style="text-align: center"></p>
                    </td>
                    <td>
                        <p id="demo5" style="text-align: center"></p>
                    </td>
                    <td>
                        <p id="demo7" style="text-align: center"></p>
                    </td>
                </tr>

                <tr>
                    <td>
                        <p id="demo2" style="text-align: center"></p>
                    </td>
                    <td>
                        <p id="demo4" style="text-align: center"></p>
                    </td>
                    <td>
                        <p id="demo6" style="text-align: center"></p>
                    </td>
                    <td>
                        <p id="demo8" style="text-align: center"></p>
                    </td>
                </tr>

            </table>
            <p id="test" style="font-size: 30pt; color: darkblue"></p>



        </div>
    </div>

    <script>

        // Read the generated spes from Firebase.
        firebase.auth().onAuthStateChanged(function (user) {

            // Read CPU
            db.collection('users').doc(user.uid).onSnapshot(function (snap) {
                console.log("Current data is...", snap.data().cpu);
                document.getElementById("stuff").innerHTML = snap.data().cpu;
            });

            // Read drive
            db.collection('users').doc(user.uid).onSnapshot(function (snap) {
                console.log("Current data is...", snap.data().drive);
                document.getElementById("stuff1").innerHTML = snap.data().drive;
            });

            // Read ram
            db.collection('users').doc(user.uid).onSnapshot(function (snap) {
                console.log("Current data is...", snap.data().ram);
                document.getElementById("stuff2").innerHTML = snap.data().ram;
            });

            // Read type
            db.collection('users').doc(user.uid).onSnapshot(function (snap) {
                console.log("Current data is...", snap.data().type);
                document.getElementById("stuff3").innerHTML = snap.data().type;
            });

            // Read message
            db.collection('users').doc(user.uid).onSnapshot(function (snap) {
                console.log("Current data is...", snap.data().message);
                document.getElementById("stuff4").innerHTML = snap.data().message;
            });

        });

        // Get recommended shops function. Read from Firebase.
        function getShops() {
            var store = db.collection('Stores');

            // Costco
            document.getElementById("store1").innerHTML = "Costco";

            // Return policy of Costco
            store.doc('Costco').onSnapshot(function (snap) {
                console.log("Current data is...", snap.data());
                document.getElementById("demo").innerHTML = snap.data().returnpolicy;
            });

            // Price match of Costco
            store.doc('Costco').onSnapshot(function (snap) {
                console.log("Current data is...", snap.data());
                document.getElementById("demo2").innerHTML = snap.data().pricematch;
            });

            // Best Buy
            document.getElementById("store2").innerHTML = "Bestbuy";

            // Return policy of Best Buy
            db.collection('Stores').doc('bestbuy').onSnapshot(function (snap) {
                console.log("Current data is...", snap.data());
                document.getElementById("demo3").innerHTML = snap.data().returnpolicy;
            });

            // Price match of Best Buy
            db.collection('Stores').doc('bestbuy').onSnapshot(function (snap) {
                console.log("Current data is...", snap.data());
                document.getElementById("demo4").innerHTML = snap.data().pricematch;
            });

            // Amazon
            document.getElementById("store3").innerHTML = "Amazon";

            // Return policy of Amazon
            db.collection('Stores').doc('Amazon').onSnapshot(function (snap) {
                console.log("Current data is...", snap.data());
                document.getElementById("demo5").innerHTML = snap.data().returnpolicy;
            });

            // Price match of Amazon
            db.collection('Stores').doc('Amazon').onSnapshot(function (snap) {
                console.log("Current data is...", snap.data());
                document.getElementById("demo6").innerHTML = snap.data().pricematch;
            });

            //Staples
            document.getElementById("store4").innerHTML = "Staples";

            // Return policy of Staples
            db.collection('Stores').doc('Staples').onSnapshot(function (snap) {
                console.log("Current data is...", snap.data());
                document.getElementById("demo7").innerHTML = snap.data().returnpolicy;
            });

            // Price match of Staples
            db.collection('Stores').doc('Staples').onSnapshot(function (snap) {
                console.log("Current data is...", snap.data());
                document.getElementById("demo8").innerHTML = snap.data().pricematch;
            });


            // This is the query function using .where().
            var costco = db.collection('Stores').where('costco', '==', 'Costco is the best!!!');
            costco.get().then(function (querySnapshot) {
                querySnapshot.forEach(function (doc) {

                    document.getElementById("test").innerHTML = doc.data().costco;

                });
            });

        }

    </script>

</body>

</html>
